<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMarket - Market</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/styles/main.css">
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js"></script>
</head>
<body>
    <header>
        <div class="logo-container">
            <img src="../images/gmarket-logo.png" alt="GMarket Logo" class="logo">
        </div>
        <nav>
            <ul>
                <li><a href="/pages/home.html">Home</a></li>
                <li><a href="/pages/contact.html">Contact Us</a></li>
                <li class="auth-not-required"><a href="/pages/signin.html">Sign In</a></li>
                <li class="auth-not-required"><a href="/pages/signup.html">Sign Up</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <h1>Markets</h1>

        <section id="indices" class="market-section">
            <h2>Indices</h2>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <h3 class="chart-title">S&P 500</h3>
                    <div class="chart" id="index-sp500"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">NASDAQ 100</h3>
                    <div class="chart" id="index-nasdaq"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">Dow Jones</h3>
                    <div class="chart" id="index-djia"></div>
                </div>
            </div>
        </section>

        <section id="stocks" class="market-section">
            <h2>Stocks</h2>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <h3 class="chart-title">AAPL - Apple Inc.</h3>
                    <div class="chart" id="stock-aapl"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">GOOGL - Alphabet Inc.</h3>
                    <div class="chart" id="stock-googl"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">MSFT - Microsoft Corp.</h3>
                    <div class="chart" id="stock-msft"></div>
                </div>
            </div>
        </section>

        <section id="etfs" class="market-section">
            <h2>ETFs</h2>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <h3 class="chart-title">SPY - SPDR S&P 500</h3>
                    <div class="chart" id="etf-spy"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">QQQ - Invesco QQQ</h3>
                    <div class="chart" id="etf-qqq"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">IWM - iShares Russell 2000</h3>
                    <div class="chart" id="etf-iwm"></div>
                </div>
            </div>
        </section>

        <section id="crypto" class="market-section">
            <h2>Cryptocurrencies</h2>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <h3 class="chart-title">BTC/USD - Bitcoin</h3>
                    <div class="chart" id="crypto-btcusd"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">ETH/USD - Ethereum</h3>
                    <div class="chart" id="crypto-ethusd"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">BNB/USD - Binance Coin</h3>
                    <div class="chart" id="crypto-bnbusd"></div>
                </div>
            </div>
        </section>

        <section id="forex" class="market-section">
            <h2>Forex</h2>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <h3 class="chart-title">EUR/USD - Euro</h3>
                    <div class="chart" id="forex-eurusd"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">GBP/USD - British Pound</h3>
                    <div class="chart" id="forex-gbpusd"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">USD/JPY - Japanese Yen</h3>
                    <div class="chart" id="forex-usdjpy"></div>
                </div>
            </div>
        </section>

        <section id="futures" class="market-section">
            <h2>Futures</h2>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <h3 class="chart-title">ES - E-mini S&P 500</h3>
                    <div class="chart" id="futures-es"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">NQ - E-mini NASDAQ</h3>
                    <div class="chart" id="futures-nq"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">CL - Crude Oil</h3>
                    <div class="chart" id="futures-cl"></div>
                </div>
            </div>
        </section>

        <section id="bonds" class="market-section">
            <h2>Bonds</h2>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <h3 class="chart-title">US10Y - US 10Y Treasury</h3>
                    <div class="chart" id="bond-us10"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">US30Y - US 30Y Treasury</h3>
                    <div class="chart" id="bond-us30"></div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">DE10Y - German 10Y Bund</h3>
                    <div class="chart" id="bond-de10"></div>
                </div>
            </div>
        </section>
        <div id="loading-indicator" class="loading-container">
            <div class="loading-spinner"></div>
        </div>
    </main>
    <footer>
        <p>&copy; <span id="current-year"></span> GMarket. All rights reserved.</p>
    </footer>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script>
        const firebaseConfig = {
            // Your Firebase config here
        };
        firebase.initializeApp(firebaseConfig);
    </script>
    <script type="module" src="/scripts/main.js"></script>
    <script>
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>
    <script>
        function createChart(container, symbol, type = 'line') {
            return new Promise((resolve, reject) => {
                try {
                    const chartContainer = document.getElementById(container);
                    const widget = new TradingView.widget({
                        "width": "100%",
                        "height": "100%",
                        "symbol": symbol,
                        "interval": "D",
                        "timezone": "exchange",
                        "theme": "dark",
                        "style": "1",
                        "locale": "en",
                        "toolbar_bg": "#f1f3f6",
                        "enable_publishing": false,
                        "allow_symbol_change": true,
                        "container_id": container,
                        "hide_top_toolbar": false,
                        "hide_legend": false,
                        "save_image": false,
                        "studies": [
                            "MASimple@tv-basicstudies"
                        ],
                        "show_popup_button": true,
                        "popup_width": "1000",
                        "popup_height": "650",
                        "autosize": true
                    });

                    widget.onChartReady(() => {
                        resolve();
                    });

                } catch (error) {
                    console.error(`Error creating chart for ${symbol}:`, error);
                    reject(error);
                }
            });
        }

        function hideLoading() {
            document.getElementById('loading-indicator').style.display = 'none';
        }

        const charts = [
            // Indices
            { id: "index-sp500", symbol: "SPX", title: "S&P 500" },
            { id: "index-nasdaq", symbol: "NASDAQ:NDX", title: "NASDAQ 100" },
            { id: "index-djia", symbol: "DJIA", title: "Dow Jones" },

            // Stocks
            { id: "stock-aapl", symbol: "AAPL", title: "Apple Inc." },
            { id: "stock-msft", symbol: "MSFT", title: "Microsoft" },
            { id: "stock-googl", symbol: "GOOGL", title: "Alphabet" },

            // ETFs
            { id: "etf-spy", symbol: "SPY", title: "SPDR S&P 500" },
            { id: "etf-qqq", symbol: "QQQ", title: "Invesco QQQ" },
            { id: "etf-iwm", symbol: "IWM", title: "iShares Russell 2000" },

            // Crypto
            { id: "crypto-btcusd", symbol: "BINANCE:BTCUSDT", title: "Bitcoin" },
            { id: "crypto-ethusd", symbol: "BINANCE:ETHUSDT", title: "Ethereum" },
            { id: "crypto-bnbusd", symbol: "BINANCE:BNBUSDT", title: "Binance Coin" },

            // Forex
            { id: "forex-eurusd", symbol: "EURUSD", title: "EUR/USD" },
            { id: "forex-gbpusd", symbol: "GBPUSD", title: "GBP/USD" },
            { id: "forex-usdjpy", symbol: "USDJPY", title: "USD/JPY" },

            // Futures
            { id: "futures-es", symbol: "ES1!", title: "E-mini S&P 500" },
            { id: "futures-nq", symbol: "NQ1!", title: "E-mini NASDAQ" },
            { id: "futures-cl", symbol: "CL1!", title: "Crude Oil" },

            // Bonds
            { id: "bond-us10", symbol: "US10Y", title: "US 10Y Treasury" },
            { id: "bond-us30", symbol: "US30Y", title: "US 30Y Treasury" },
            { id: "bond-de10", symbol: "DE10Y", title: "German 10Y Bund" }
        ];

        function initCharts() {
            charts.forEach(chart => {
                const wrapper = document.getElementById(chart.id).parentElement;
                const titleEl = wrapper.querySelector('.chart-title');
                if (titleEl) {
                    titleEl.textContent = chart.title;
                }
                createChart(chart.id, chart.symbol)
                    .then(() => {
                        // ... existing code ...
                    })
                    .catch(() => {
                        // ... existing code ...
                    });
            });
        }

        document.addEventListener('DOMContentLoaded', initCharts);
    </script>
    <script>
        function showErrorMessage(message) {
            const errorDiv = document.createElement('div');
            errorDiv.textContent = message;
            errorDiv.style.color = 'red';
            errorDiv.style.textAlign = 'center';
            errorDiv.style.marginTop = '20px';
            document.querySelector('main').appendChild(errorDiv);
        }
    </script>
    <div id="logout-container" class="auth-required" style="position: fixed; bottom: 20px; right: 20px; display: none;">
        <button id="logoutBtn">Logout</button>
    </div>
</body>
</html>
